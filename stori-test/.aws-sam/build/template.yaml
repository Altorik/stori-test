AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'stori-test

  '
Globals:
  Function:
    Timeout: 5
    MemorySize: 128
Parameters:
  SqsSendEmail:
    Description: queue for send summary to client
    Type: String
    Default: sqs-send-emails
  FileToProcess:
    Description: file to process
    Type: String
    Default: csv_client_2.csv
  SqsSendEmailDLQ:
    Description: queue for send summary to client DLQ
    Type: String
    Default: sqs-send-emails-dlq
  S3BucketName:
    Description: Name bucket that contains csv
    Type: String
    Default: test-stori-19871118
  EmailIdentity:
    Description: email from
    Type: String
    Default: altorik@gmail.com
  EmailTemplate:
    Description: email template
    Type: String
    Default: stori-summary
  QueuesProcessed:
    Description: Dynamodb Table for queues processed
    Type: String
    Default: dyndb-queues-processed
Resources:
  RoleFunctionProcessFile:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - lambda.amazonaws.com
          Action:
          - sts:AssumeRole
      Path: /
      Policies:
      - PolicyName: root
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - s3:*
            Resource:
              Fn::Sub: arn:aws:s3:::${S3BucketName}/*
          - Effect: Allow
            Action:
            - sqs:*
            Resource:
              Fn::Sub: arn:aws:sqs:${AWS::Region}:${AWS::AccountId}:${SqsSendEmail}
          - Effect: Allow
            Action:
            - dynamodb:*
            Resource:
              Fn::Sub: arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${QueuesProcessed}
          - Effect: Allow
            Action:
            - logs:CreateLogGroup
            - logs:CreateLogStream
            - logs:PutLogEvents
            Resource: '*'
          - Effect: Allow
            Action:
            - sesv2:*
            - ses:*
            Resource:
            - Fn::Sub: arn:aws:ses:${AWS::Region}:${AWS::AccountId}:template/${EmailTemplate}
            - Fn::Sub: arn:aws:ses:${AWS::Region}:${AWS::AccountId}:identity/${EmailIdentity}
  ProcessFunction:
    Type: AWS::Serverless::Function
    Metadata:
      BuildMethod: go1.x
      SamResourceId: ProcessFunction
    Properties:
      CodeUri: ProcessFunction
      Handler: main
      Runtime: go1.x
      Architectures:
      - x86_64
      Role:
        Fn::GetAtt:
        - RoleFunctionProcessFile
        - Arn
      Environment:
        Variables:
          STORI_CUENTAAWS:
            Ref: AWS::AccountId
          STORI_REGION:
            Ref: AWS::Region
          STORI_BUCKETNAME:
            Ref: S3BucketName
          STORI_QUEUENAME:
            Ref: SqsSendEmail
          STORI_FILENAME:
            Ref: FileToProcess
  SQSSendEmail:
    Type: AWS::SQS::Queue
    Properties:
      QueueName:
        Ref: SqsSendEmail
      RedrivePolicy:
        deadLetterTargetArn:
          Fn::GetAtt:
          - SQSSendEmailDLQ
          - Arn
        maxReceiveCount: 5
  SQSSendEmailDLQ:
    Type: AWS::SQS::Queue
    Properties:
      QueueName:
        Ref: SqsSendEmailDLQ
  S3Files:
    Type: AWS::S3::Bucket
    Properties:
      BucketName:
        Ref: S3BucketName
  IdentitySES:
    Type: AWS::SES::EmailIdentity
    Properties:
      EmailIdentity:
        Ref: EmailIdentity
  EmailTemplateSES:
    Type: AWS::SES::Template
    Properties:
      Template:
        HtmlPart: "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\
          \ \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html\
          \ xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"\
          \ style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\r\
          \n <head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta content=\"width=device-width,\
          \ initial-scale=1\" name=\"viewport\">\r\n  <meta name=\"x-apple-disable-message-reformatting\"\
          >\r\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n  <meta\
          \ content=\"telephone=no\" name=\"format-detection\">\r\n  <title>New Template</title><!--[if\
          \ (mso 16)]>\r\n    <style type=\"text/css\">\r\n    a {text-decoration:\
          \ none;}\r\n    </style>\r\n    <![endif]--><!--[if gte mso 9]><style>sup\
          \ { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\r\
          \n<xml>\r\n    <o:OfficeDocumentSettings>\r\n    <o:AllowPNG></o:AllowPNG>\r\
          \n    <o:PixelsPerInch>96</o:PixelsPerInch>\r\n    </o:OfficeDocumentSettings>\r\
          \n</xml>\r\n<![endif]-->\r\n  <style type=\"text/css\">\r\n#outlook a {\r\
          \n\tpadding:0;\r\n}\r\n.es-button {\r\n\tmso-style-priority:100!important;\r\
          \n\ttext-decoration:none!important;\r\n}\r\na[x-apple-data-detectors] {\r\
          \n\tcolor:inherit!important;\r\n\ttext-decoration:none!important;\r\n\t\
          font-size:inherit!important;\r\n\tfont-family:inherit!important;\r\n\tfont-weight:inherit!important;\r\
          \n\tline-height:inherit!important;\r\n}\r\n.es-desk-hidden {\r\n\tdisplay:none;\r\
          \n\tfloat:left;\r\n\toverflow:hidden;\r\n\twidth:0;\r\n\tmax-height:0;\r\
          \n\tline-height:0;\r\n\tmso-hide:all;\r\n}\r\n@media only screen and (max-width:600px)\
          \ {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2\
          \ a, h3 a { line-height:120%!important } h1 { font-size:30px!important;\
          \ text-align:left } h2 { font-size:24px!important; text-align:left } h3\
          \ { font-size:20px!important; text-align:left } h1 a { text-align:left }\
          \ .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important\
          \ } h2 a { text-align:left } .es-header-body h2 a, .es-content-body h2 a,\
          \ .es-footer-body h2 a { font-size:24px!important } h3 a { text-align:left\
          \ } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a {\
          \ font-size:20px!important } .es-menu td a { font-size:14px!important }\
          \ .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body\
          \ a { font-size:14px!important } .es-content-body p, .es-content-body ul\
          \ li, .es-content-body ol li, .es-content-body a { font-size:14px!important\
          \ } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body\
          \ a { font-size:16px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock\
          \ ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"\
          ] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2,\
          \ .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r\
          \ h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l,\
          \ .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important\
          \ } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important\
          \ } .es-button-border { display:inline-block!important } a.es-button, button.es-button\
          \ { font-size:18px!important; display:inline-block!important } .es-adaptive\
          \ table, .es-left, .es-right { width:100%!important } .es-content table,\
          \ .es-header table, .es-footer table, .es-content, .es-footer, .es-header\
          \ { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important;\
          \ width:100%!important } .adapt-img { width:100%!important; height:auto!important\
          \ } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important\
          \ } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important\
          \ } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important\
          \ } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden,\
          \ td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important;\
          \ float:none!important; max-height:inherit!important; line-height:inherit!important\
          \ } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden\
          \ { display:table!important } td.es-desk-menu-hidden { display:table-cell!important\
          \ } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html\
          \ table { width:auto!important } table.es-social { display:inline-block!important\
          \ } table.es-social td { display:inline-block!important } .es-desk-hidden\
          \ { display:table-row!important; width:auto!important; overflow:visible!important;\
          \ max-height:inherit!important } }\r\n</style>\r\n </head>\r\n <body style=\"\
          width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\"\
          >\r\n  <div class=\"es-wrapper-color\" style=\"background-color:#F6F6F6\"\
          ><!--[if gte mso 9]>\r\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\"\
          \ fill=\"t\">\r\n\t\t\t\t<v:fill type=\"tile\" color=\"#f6f6f6\"></v:fill>\r\
          \n\t\t\t</v:background>\r\n\t\t<![endif]-->\r\n   <table class=\"es-wrapper\"\
          \ cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center\
          \ top;background-color:#F6F6F6\">\r\n     <tr>\r\n      <td valign=\"top\"\
          \ style=\"padding:0;Margin:0\">\r\n       <table class=\"es-content\" cellspacing=\"\
          0\" cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td class=\"es-adaptive\
          \ es-info-area\" align=\"center\" style=\"padding:0;Margin:0\">\r\n    \
          \       <table class=\"es-content-body\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" bgcolor=\"#ffffff\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:10px;Margin:0\"\
          ><!--[if mso]><table style=\"width:580px\"><tr><td style=\"width:280px\"\
          \ valign=\"top\"><![endif]-->\r\n               <table class=\"es-left\"\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"\
          >\r\n                 <tr>\r\n                  <td align=\"left\" style=\"\
          padding:0;Margin:0;width:280px\">\r\n                   <table cellspacing=\"\
          0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\
          \ es-m-txt-c\" align=\"left\" style=\"padding:0;Margin:0;line-height:14px;font-size:12px;color:#CCCCCC\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:14px;color:#CCCCCC;font-size:12px\"\
          >Preheader text</p></td>\r\n                     </tr>\r\n             \
          \      </table></td>\r\n                 </tr>\r\n               </table><!--[if\
          \ mso]></td><td style=\"width:20px\"></td><td style=\"width:280px\" valign=\"\
          top\"><![endif]-->\r\n               <table class=\"es-right\" cellspacing=\"\
          0\" cellpadding=\"0\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\"\
          >\r\n                 <tr>\r\n                  <td align=\"left\" style=\"\
          padding:0;Margin:0;width:280px\">\r\n                   <table cellspacing=\"\
          0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\
          \ es-m-txt-c\" align=\"right\" style=\"padding:0;Margin:0;line-height:14px;font-size:12px;color:#CCCCCC\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:14px;color:#CCCCCC;font-size:12px\"\
          ><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#CCCCCC;font-size:12px\"\
          >View in browser</a></p></td>\r\n                     </tr>\r\n        \
          \           </table></td>\r\n                 </tr>\r\n               </table><!--[if\
          \ mso]></td></tr></table><![endif]--></td>\r\n             </tr>\r\n   \
          \        </table></td>\r\n         </tr>\r\n       </table>\r\n       <table\
          \ class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td class=\"es-adaptive\
          \ es-info-area\" align=\"center\" style=\"padding:0;Margin:0\">\r\n    \
          \       <table class=\"es-content-body\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" bgcolor=\"#ffffff\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:10px;Margin:0\"\
          ><!--[if mso]><table style=\"width:580px\"><tr><td style=\"width:280px\"\
          \ valign=\"top\"><![endif]-->\r\n               <table class=\"es-left\"\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"\
          >\r\n                 <tr class=\"es-mobile-hidden\">\r\n              \
          \    <td align=\"left\" style=\"padding:0;Margin:0;width:280px\">\r\n  \
          \                 <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"\
          \ role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\"\
          \ align=\"left\" style=\"padding:0;Margin:0;line-height:14px;font-size:12px;color:#CCCCCC\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:14px;color:#CCCCCC;font-size:12px\"\
          >Preheader text (hidden on mobile)</p></td>\r\n                     </tr>\r\
          \n                   </table></td>\r\n                 </tr>\r\n       \
          \        </table><!--[if mso]></td><td style=\"width:20px\"></td><td style=\"\
          width:280px\" valign=\"top\"><![endif]-->\r\n               <table class=\"\
          es-right\" cellspacing=\"0\" cellpadding=\"0\" align=\"right\" style=\"\
          mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\"\
          >\r\n                 <tr>\r\n                  <td align=\"left\" style=\"\
          padding:0;Margin:0;width:280px\">\r\n                   <table cellspacing=\"\
          0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\
          \ es-m-txt-c\" align=\"right\" style=\"padding:0;Margin:0;line-height:14px;font-size:12px;color:#CCCCCC\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:14px;color:#CCCCCC;font-size:12px\"\
          ><a href=\"http://#\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#CCCCCC;font-size:12px\"\
          \ _blank>View in browser</a></p></td>\r\n                     </tr>\r\n\
          \                   </table></td>\r\n                 </tr>\r\n        \
          \       </table><!--[if mso]></td></tr></table><![endif]--></td>\r\n   \
          \          </tr>\r\n           </table></td>\r\n         </tr>\r\n     \
          \  </table>\r\n       <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td class=\"es-adaptive\"\
          \ align=\"center\" style=\"padding:0;Margin:0\">\r\n           <table class=\"\
          es-content-body\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"\
          mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:10px;Margin:0\"\
          >\r\n               <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td valign=\"top\" align=\"\
          center\" style=\"padding:0;Margin:0;width:580px\">\r\n                 \
          \  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\"\
          \ align=\"center\" style=\"padding:0;Margin:0;line-height:14px;font-size:12px;color:#CCCCCC\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:14px;color:#CCCCCC;font-size:12px\"\
          ><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#CCCCCC;font-size:12px\"\
          >View in browser</a></p></td>\r\n                     </tr>\r\n        \
          \           </table></td>\r\n                 </tr>\r\n               </table></td>\r\
          \n             </tr>\r\n           </table></td>\r\n         </tr>\r\n \
          \      </table>\r\n       <table class=\"es-header\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center\
          \ top\">\r\n         <tr>\r\n          <td align=\"center\" style=\"padding:0;Margin:0\"\
          >\r\n           <table class=\"es-header-body\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#ffffff;width:600px\"\
          \ cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\"\
          >\r\n             <tr>\r\n              <td style=\"padding:10px;Margin:0;background-color:#ffffff\"\
          \ bgcolor=\"#ffffff\" align=\"left\">\r\n               <table cellspacing=\"\
          0\" cellpadding=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td valign=\"top\" align=\"\
          center\" style=\"padding:0;Margin:0;width:580px\">\r\n                 \
          \  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td align=\"center\"\
          \ style=\"padding:0;Margin:0;font-size:0px\"><img src=\"https://dwsfnb.stripocdn.email/content/guids/CABINET_10515828eb40992f1c2a7a069a01f3009a1a81b2f5aa069a83ed481dbc5b7a57/images/logo.png\"\
          \ alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"\
          \ height=\"41\"></td>\r\n                     </tr>\r\n                \
          \   </table></td>\r\n                 </tr>\r\n               </table></td>\r\
          \n             </tr>\r\n           </table></td>\r\n         </tr>\r\n \
          \      </table>\r\n       <table class=\"es-header\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center\
          \ top\">\r\n         <tr>\r\n          <td class=\"es-adaptive\" align=\"\
          center\" style=\"padding:0;Margin:0\">\r\n           <table class=\"es-header-body\"\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;width:600px\"\
          >\r\n             <tr>\r\n              <td style=\"padding:15px;Margin:0;background-color:#35d0b8;border-bottom:1px\
          \ solid #2cb543\" bgcolor=\"#35d0b8\" align=\"left\"><!--[if mso]><table\
          \ style=\"width:570px\" cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"\
          width:180px\" valign=\"top\"><![endif]-->\r\n               <table class=\"\
          es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"\
          >\r\n                 <tr>\r\n                  <td class=\"es-m-p0r es-m-p20b\"\
          \ valign=\"top\" align=\"center\" style=\"padding:0;Margin:0;width:180px\"\
          >\r\n                   <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td align=\"center\"\
          \ style=\"padding:0;Margin:0;display:none\"></td>\r\n                  \
          \   </tr>\r\n                   </table></td>\r\n                 </tr>\r\
          \n               </table><!--[if mso]></td><td style=\"width:20px\"></td><td\
          \ style=\"width:370px\" valign=\"top\"><![endif]-->\r\n               <table\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td align=\"left\" style=\"\
          padding:0;Margin:0;width:370px\">\r\n                   <table cellspacing=\"\
          0\" cellpadding=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td align=\"center\"\
          \ style=\"padding:0;Margin:0;display:none\"></td>\r\n                  \
          \   </tr>\r\n                   </table></td>\r\n                 </tr>\r\
          \n               </table><!--[if mso]></td></tr></table><![endif]--></td>\r\
          \n             </tr>\r\n           </table></td>\r\n         </tr>\r\n \
          \      </table>\r\n       <table class=\"es-content\" cellspacing=\"0\"\
          \ cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td align=\"center\"\
          \ style=\"padding:0;Margin:0\">\r\n           <table class=\"es-content-body\"\
          \ cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:20px;Margin:0\"\
          >\r\n               <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td valign=\"top\" align=\"\
          center\" style=\"padding:0;Margin:0;width:560px\">\r\n                 \
          \  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-m-txt-c\"\
          \ align=\"center\" style=\"padding:0;Margin:0\"><h2 style=\"Margin:0;line-height:29px;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;font-size:24px;font-style:normal;font-weight:normal;color:#333333\"\
          >Summary</h2></td>\r\n                     </tr>\r\n                   \
          \  <tr>\r\n                      <td align=\"center\" style=\"padding:0;Margin:0;padding-top:10px;padding-left:20px;padding-right:20px;font-size:0\"\
          >\r\n                       <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          10%\" height=\"100%\" border=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                         <tr>\r\n                          <td style=\"\
          padding:0;Margin:0;border-bottom:3px solid #31cb4b;background:none;height:1px;width:100%;margin:0px\"\
          ></td>\r\n                         </tr>\r\n                       </table></td>\r\
          \n                     </tr>\r\n                   </table></td>\r\n   \
          \              </tr>\r\n               </table></td>\r\n             </tr>\r\
          \n           </table></td>\r\n         </tr>\r\n       </table>\r\n    \
          \   <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"\
          center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td align=\"center\"\
          \ style=\"padding:0;Margin:0\">\r\n           <table class=\"es-content-body\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#ffffff;width:600px\"\
          \ cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:0;Margin:0\"\
          >\r\n               <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td align=\"center\" valign=\"\
          top\" style=\"padding:0;Margin:0;width:600px\">\r\n                   <table\
          \ cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td align=\"left\"\
          \ style=\"padding:15px;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:georgia,\
          \ times, 'times new roman', serif;line-height:21px;color:#333333;font-size:14px\"\
          >Total balance is {{TotalBalance}}</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:georgia,\
          \ times, 'times new roman', serif;line-height:21px;color:#333333;font-size:14px\"\
          >Average debit amount: {{AverageDebitAmount}}<br>Average credit amount:\
          \ {{AverageCreditAmount}}<br></p></td>\r\n                     </tr>\r\n\
          \                   </table></td>\r\n                 </tr>\r\n        \
          \       </table></td>\r\n             </tr>\r\n           </table></td>\r\
          \n         </tr>\r\n       </table>\r\n       <table cellpadding=\"0\" cellspacing=\"\
          0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td align=\"center\"\
          \ style=\"padding:0;Margin:0\">\r\n           <table bgcolor=\"#ffffff\"\
          \ class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"\
          0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px\"\
          >\r\n               <table cellpadding=\"0\" cellspacing=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td align=\"center\" valign=\"\
          top\" style=\"padding:0;Margin:0;width:560px\">\r\n                   <table\
          \ cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td align=\"left\"\
          \ style=\"padding:0;Margin:0\">\r\n                        {{#each TransactionsByMonth}}\r\
          \n                          <ul>\r\n                            <li style=\"\
          -webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;Margin-bottom:15px;margin-left:0;color:#333333;font-size:14px\"\
          ><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"\
          >Number of transactions in {{NameMonth}}: {{Transactions}}</p></li>\r\n\
          \                          </ul></td>\r\n                        {{/each}}\r\
          \n                     </tr>\r\n                     <tr>\r\n          \
          \            <td align=\"center\" style=\"padding:20px;Margin:0;font-size:0\"\
          >\r\n                       <table border=\"0\" width=\"100%\" height=\"\
          100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"\
          mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                         <tr>\r\n                          <td style=\"\
          padding:0;Margin:0;border-bottom:1px solid #cccccc;background:unset;height:1px;width:100%;margin:0px\"\
          ></td>\r\n                         </tr>\r\n                       </table></td>\r\
          \n                     </tr>\r\n                   </table></td>\r\n   \
          \              </tr>\r\n               </table></td>\r\n             </tr>\r\
          \n           </table></td>\r\n         </tr>\r\n       </table>\r\n    \
          \   <table class=\"es-footer\" cellspacing=\"0\" cellpadding=\"0\" align=\"\
          center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center\
          \ top\">\r\n         <tr>\r\n          <td align=\"center\" style=\"padding:0;Margin:0\"\
          >\r\n           <table class=\"es-footer-body\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#333333;width:600px\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"Margin:0;padding-top:25px;padding-bottom:25px;padding-left:40px;padding-right:40px\"\
          ><!--[if mso]><table style=\"width:520px\" cellpadding=\"0\" cellspacing=\"\
          0\"><tr><td style=\"width:180px\"><![endif]-->\r\n               <table\
          \ class=\"es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"\
          mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"\
          >\r\n                 <tr>\r\n                  <td class=\"es-m-p0r es-m-p20b\"\
          \ align=\"center\" style=\"padding:0;Margin:0;width:160px\">\r\n       \
          \            <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"\
          presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-m-txt-c\"\
          \ align=\"left\" style=\"padding:0;Margin:0;padding-bottom:10px\"><h3 style=\"\
          Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#ffffff\"\
          >Contact Us</h3></td>\r\n                     </tr>\r\n                \
          \     <tr>\r\n                      <td class=\"es-m-txt-c\" align=\"left\"\
          \ style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;font-size:14px\"\
          >Address: 1</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;font-size:14px\"\
          >Address: 2</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;font-size:14px\"\
          ><br></p></td>\r\n                     </tr>\r\n                   </table></td>\r\
          \n                  <td class=\"es-hidden\" style=\"padding:0;Margin:0;width:20px\"\
          ></td>\r\n                 </tr>\r\n               </table><!--[if mso]></td><td\
          \ style=\"width:160px\"><![endif]-->\r\n               <table class=\"es-left\"\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"\
          >\r\n                 <tr>\r\n                  <td class=\"es-m-p0r es-m-p20b\"\
          \ align=\"center\" style=\"padding:0;Margin:0;width:160px\">\r\n       \
          \            <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"\
          presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-m-txt-c\"\
          \ align=\"center\" style=\"padding:0;Margin:0;padding-bottom:10px\"><h3\
          \ style=\"Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#ffffff\"\
          >Recommended</h3></td>\r\n                     </tr>\r\n               \
          \      <tr>\r\n                      <td class=\"es-m-txt-c\" align=\"center\"\
          \ style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;font-size:14px\"\
          ><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >New Release</a><br><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Best Seller</a><br><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Promotional</a><br><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Pre Order</a></p></td>\r\n                     </tr>\r\n              \
          \     </table></td>\r\n                 </tr>\r\n               </table><!--[if\
          \ mso]></td><td style=\"width:20px\"></td><td style=\"width:160px\"><![endif]-->\r\
          \n               <table class=\"es-right\" cellspacing=\"0\" cellpadding=\"\
          0\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\"\
          >\r\n                 <tr>\r\n                  <td class=\"es-m-p0r es-m-p20b\"\
          \ align=\"center\" style=\"padding:0;Margin:0;width:160px\">\r\n       \
          \            <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"\
          presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-m-txt-c\"\
          \ align=\"right\" style=\"padding:0;Margin:0;padding-bottom:10px\"><h3 style=\"\
          Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#ffffff\"\
          >Newsletter</h3></td>\r\n                     </tr>\r\n                \
          \     <tr>\r\n                      <td class=\"es-m-txt-c\" align=\"right\"\
          \ style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial,\
          \ 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;font-size:14px\"\
          ><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Forward</a><br><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Unsubscribe</a><br><a href=\"http://#\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#FFFFFF;font-size:14px\"\
          >Home</a></p></td>\r\n                     </tr>\r\n                   </table></td>\r\
          \n                 </tr>\r\n               </table><!--[if mso]></td></tr></table><![endif]--></td>\r\
          \n             </tr>\r\n           </table></td>\r\n         </tr>\r\n \
          \      </table>\r\n       <table class=\"es-content\" cellspacing=\"0\"\
          \ cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed\
          \ !important;width:100%\">\r\n         <tr>\r\n          <td class=\"es-info-area\"\
          \ align=\"center\" style=\"padding:0;Margin:0\">\r\n           <table class=\"\
          es-content-body\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;width:600px\"\
          \ cellspacing=\"0\" cellpadding=\"0\" align=\"center\" bgcolor=\"#FFFFFF\"\
          >\r\n             <tr>\r\n              <td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-top:30px;padding-bottom:30px\"\
          >\r\n               <table cellspacing=\"0\" cellpadding=\"0\" width=\"\
          100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                 <tr>\r\n                  <td valign=\"top\" align=\"\
          center\" style=\"padding:0;Margin:0;width:560px\">\r\n                 \
          \  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" role=\"presentation\"\
          \ style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"\
          >\r\n                     <tr>\r\n                      <td class=\"es-infoblock\
          \ made_with\" align=\"center\" style=\"padding:0;Margin:0;line-height:0px;font-size:0px;color:#CCCCCC\"\
          ><a target=\"_blank\" href=\"http://viewstripo.email/?utm_source=templates&utm_medium=email&utm_campaign=basic&utm_content=master\"\
          \ style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#CCCCCC;font-size:12px\"\
          ><img src=\"https://dwsfnb.stripocdn.email/content/guids/CABINET_10515828eb40992f1c2a7a069a01f3009a1a81b2f5aa069a83ed481dbc5b7a57/images/logo.png\"\
          \ alt width=\"125\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"\
          ></a></td>\r\n                     </tr>\r\n                   </table></td>\r\
          \n                 </tr>\r\n               </table></td>\r\n           \
          \  </tr>\r\n           </table></td>\r\n         </tr>\r\n       </table></td>\r\
          \n     </tr>\r\n   </table>\r\n  </div>\r\n </body>\r\n</html>"
        SubjectPart: Summary
        TemplateName:
          Ref: EmailTemplate
  ACLSendEmailFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: ACLSendEmailFunction
      Handler: main
      Runtime: go1.x
      Architectures:
      - x86_64
      Events:
        SendEmailEvent:
          Type: SQS
          Properties:
            Queue:
              Fn::GetAtt:
              - SQSSendEmail
              - Arn
            BatchSize: 10
      Role:
        Fn::GetAtt:
        - RoleFunctionProcessFile
        - Arn
      Environment:
        Variables:
          STORI_CUENTAAWS:
            Ref: AWS::AccountId
          STORI_REGION:
            Ref: AWS::Region
          STORI_QUEUENAME:
            Ref: SqsSendEmail
          STORI_TEMPLATENAME:
            Ref: EmailTemplate
          STORI_EMAILNAME:
            Ref: EmailIdentity
          STORI_TABLENAME:
            Ref: QueuesProcessed
    Metadata:
      SamResourceId: ACLSendEmailFunction
  ACLQueuesProcessed:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName:
        Ref: QueuesProcessed
      BillingMode: PROVISIONED
      AttributeDefinitions:
      - AttributeName: MessageId
        AttributeType: S
      - AttributeName: DateEvent
        AttributeType: S
      KeySchema:
      - AttributeName: MessageId
        KeyType: HASH
      - AttributeName: DateEvent
        KeyType: RANGE
      ProvisionedThroughput:
        ReadCapacityUnits: 2
        WriteCapacityUnits: 2
      StreamSpecification:
        StreamViewType: NEW_IMAGE
